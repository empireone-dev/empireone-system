import{r as d,u as k,j as t,s as N}from"./app-C3s8st1b.js";import{u as v}from"./index.esm-4mnpPue6.js";import{B as u}from"./button-rP9JlgwF.js";import{M as C}from"./modal-Dw6HqqxW.js";import{S as T}from"./select-t1UEVq9T.js";import{S as _}from"./swal-E5NWN_Wn.js";import{T as w}from"./textarea-DnCU5OKG.js";import{t as E}from"./search-lib-CU0dLCsd.js";import{f as q,g as A}from"./ticket-thunk-DYpLYYAv.js";import"./index-DNj7-gnP.js";import"./transition-D4kA6QSk.js";import"./sweetalert2.esm.all-EtYCW2yB.js";const B=["Need more information","Ticket resolved successfully","Customer not responding","Escalated to support","Invalid request"];function J(){var n,c;const[m,o]=d.useState(!1),[r,i]=d.useState([]),{ticket:p}=k(e=>e.tickets),{register:l,handleSubmit:f,formState:{errors:a,isSubmitting:x},reset:g,setValue:O}=v({defaultValues:{notes:"",status:""}}),b=e=>{r.includes(e)||i(s=>[...s,e])},h=e=>{i(s=>s.filter(j=>j!==e))},S=async e=>{try{const s=[...r,e.notes].filter(Boolean).join(`
`);await q({...p,status:e.status,notes:s}),await N.dispatch(A(E())),await _({type:"success"}),g(),i([]),o(!1)}catch(s){console.error("Error updating ticket:",s)}},y=B.filter(e=>!r.includes(e));return t.jsxs(t.Fragment,{children:[t.jsx(u,{onClick:()=>o(!0),variant:"primary",children:"Update Ticket Status"}),t.jsx(C,{isOpen:m,width:"max-w-xl",onClose:()=>o(!1),title:"Change Ticket Status",children:t.jsxs("form",{className:"flex flex-col gap-4",onSubmit:f(S),children:[t.jsx(T,{label:"Change Status",name:"status",options:[{label:"Closed",value:"Closed"},{label:"Declined",value:"Declined"}],error:(n=a==null?void 0:a.status)==null?void 0:n.message,register:l("status",{required:"This field is required"})}),t.jsx(w,{register:l("notes"),error:(c=a==null?void 0:a.notes)==null?void 0:c.message,name:"notes",label:"Additional Notes"}),r.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((e,s)=>t.jsxs("div",{className:"flex items-center border border-gray-400 rounded-full px-3 py-1 bg-gray-100 text-sm",children:[e,t.jsx("button",{type:"button",onClick:()=>h(e),className:"ml-2 text-red-500 hover:text-red-700 font-bold",children:"Ã—"})]},s))}),t.jsx("hr",{className:"my-4 border-gray-500"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((e,s)=>t.jsx("button",{type:"button",onClick:()=>b(e),className:"border border-gray-300 rounded px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",children:e},s))}),t.jsx(u,{type:"submit",variant:"primary",loading:x,children:"Submit"})]})})]})}export{J as default};
