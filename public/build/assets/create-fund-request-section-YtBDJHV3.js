import{r as k,u as j,j as e,s as _}from"./app-Cx4Gwtk0.js";import{u as O,C as S}from"./index.esm-CE_vM16d.js";import{d as m,D as C}from"./index-TWq9k6hF.js";import{B as y}from"./button-CzKnkfCq.js";import{M as I}from"./modal-DZ10FEG8.js";import{I as o}from"./input-B0zEnAPV.js";import{U as E}from"./react-draft-wysiwyg-BNwxp0pc.js";import{h as q}from"./moment-G82_0lEo.js";import{c as T,d as U}from"./ticket-thunk-DFoIA9qZ.js";import{S as A}from"./swal-CJWkT5E4.js";import{R as B}from"./InboxOutlined-CVRWboar.js";import"./index-COC37YXg.js";import"./index-BEQqAeRs.js";import"./index-C308GkuO.js";import"./transition-B_sFIieL.js";import"./index-CyNaaEoE.js";import"./sweetalert2.esm.all-EtYCW2yB.js";const{Dragger:M}=E,{RangePicker:re}=C;function ie(){var p,u,f,g;const[N,l]=k.useState(!1),{categories:D}=j(s=>s.categories),{sites:P}=j(s=>s.sites),{register:r,handleSubmit:R,control:d,formState:{errors:t,isSubmitting:c},reset:w}=O({defaultValues:{description:"",files:[],date_range:[m(),m().add(3,"day")]}});async function F(s){const a=new FormData,[x,h]=s.date_range||[];Object.entries(s).forEach(([i,n])=>{i!=="date_range"&&(i==="files"&&(n!=null&&n.length)?Array.from(n).forEach((b,L)=>{console.log("filefile",b),a.append(`files[${L}]`,b.originFileObj)}):a.append(i,n??""))}),a.append("start",x?q(x.toISOString()).format("LLL"):""),a.append("end",h?q(h.toISOString()).format("LLL"):"");try{await _.dispatch(T(a)),_.dispatch(U()),await A({type:"success"}),w(),l(!1)}catch(i){console.error("Submit error:",i)}}return console.log("categories",D),e.jsxs(e.Fragment,{children:[e.jsx(y,{onClick:()=>l(!0),children:"Create Fund Request"}),e.jsx(I,{width:"max-w-xl",isOpen:N,onClose:l,title:"Create Fund Request",children:e.jsxs("form",{onSubmit:R(F),className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex gap-4",children:e.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{control:d,name:"date_range",rules:{required:"Please select a date range"},render:({field:s})=>e.jsx(C,{size:"large",className:"w-full border py-2.5 border-gray-900",onChange:s.onChange,value:s.value,disabledDate:a=>a&&a<m().startOf("day")})}),(t==null?void 0:t.date_range)&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.date_range.message})]}),e.jsx(o,{label:"Description",type:"text",name:"description",error:(p=t==null?void 0:t.description)==null?void 0:p.message,register:r("description",{required:"This field is required"})}),e.jsx(o,{label:"Receipt Number",type:"text",name:"receipt_number",error:(u=t==null?void 0:t.receipt_number)==null?void 0:u.message,register:r("receipt_number",{required:"This field is required"})}),e.jsx(o,{label:"Amount",type:"number",name:"amount",error:(f=t==null?void 0:t.amount)==null?void 0:f.message,register:r("amount",{required:"This field is required"})}),e.jsx(o,{label:"Balance Amount",type:"number",name:"balance",error:(g=t==null?void 0:t.balance)==null?void 0:g.message,register:r("balance",{required:"This field is required"})}),e.jsxs("div",{className:"overflow-auto",children:[e.jsx(S,{name:"files",control:d,...r("files",{}),render:({field:s})=>e.jsxs(M,{height:150,beforeUpload:()=>!1,multiple:!0,onChange:a=>s.onChange(a.fileList),fileList:s.value,children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(B,{})}),e.jsx("p",{className:"ant-upload-text",children:"Click or drag file to this area to upload"})]})}),(t==null?void 0:t.files)&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:t.files.message})]})]})}),e.jsx(y,{type:"submit",loading:c,disabled:c,children:"SUBMIT REFUND"})]})})]})}export{ie as default};
